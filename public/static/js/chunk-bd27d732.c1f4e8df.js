(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-bd27d732"],{"0b81":function(t,e,n){"use strict";n("93b6")},"16d8":function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:t.id}})},i=[],a=n("5530"),r=(n("b680"),n("a7be"),n("44f8"),n("a6e0"),n("547e")),s=n.n(r),l={minHeight:"200px",previewStyle:"vertical",useCommandShortcut:!0,useDefaultHTMLSanitizer:!0,usageStatistics:!1,hideModeSwitch:!1,toolbarItems:["heading","bold","italic","strike","divider","hr","quote","divider","ul","ol","task","indent","outdent","divider","table","image","link","divider","code","codeblock"]},c={name:"MarkdownEditor",props:{value:{type:String,default:""},id:{type:String,required:!1,default:function(){return"markdown-editor-"+ +new Date+(1e3*Math.random()).toFixed(0)}},options:{type:Object,default:function(){return l}},mode:{type:String,default:"markdown"},height:{type:String,required:!1,default:"300px"},language:{type:String,required:!1,default:"en_US"}},data:function(){return{editor:null}},computed:{editorOptions:function(){var t=Object.assign({},l,this.options);return t.initialEditType=this.mode,t.height=this.height,t.language=this.language,t}},watch:{value:function(t,e){t!==e&&t!==this.editor.getValue()&&this.editor.setValue(t)},language:function(t){this.destroyEditor(),this.initEditor()},height:function(t){this.editor.height(t)},mode:function(t){this.editor.changeMode(t)}},mounted:function(){this.initEditor()},destroyed:function(){this.destroyEditor()},methods:{initEditor:function(){var t=this;this.editor=new s.a(Object(a["a"])({el:document.getElementById(this.id)},this.editorOptions)),this.value&&this.editor.setValue(this.value),this.editor.on("change",(function(){t.$emit("input",t.editor.getValue())}))},destroyEditor:function(){this.editor&&(this.editor.off("change"),this.editor.remove())},setValue:function(t){this.editor.setValue(t)},getValue:function(){return this.editor.getValue()},setHtml:function(t){this.editor.setHtml(t)},getHtml:function(){return this.editor.getHtml()}}},u=c,d=n("2877"),p=Object(d["a"])(u,o,i,!1,null,null,null);e["a"]=p.exports},"3df7":function(t,e,n){"use strict";n("df89")},"4c66":function(t,e,n){},"58a6":function(t,e,n){},"7c98":function(t,e,n){"use strict";n("4c66")},"89f1":function(t,e,n){},"93b6":function(t,e,n){},a888:function(t,e,n){"use strict";n("caad"),n("2532"),n("ac1f"),n("5319"),n("99af");var o={bind:function(t,e,n){var o=t.querySelector(".el-dialog__header"),i=t.querySelector(".el-dialog");console.log({drag:i}),o.style.cssText+=";cursor:move;",i.style.cssText+=";top:0px;";var a=function(){return window.document.currentStyle?function(t,e){return t.currentStyle[e]}:function(t,e){return getComputedStyle(t,!1)[e]}}();o.onmousedown=function(t){var e=t.clientX-o.offsetLeft,r=t.clientY-o.offsetTop,s=i.offsetWidth,l=i.offsetHeight,c=document.body.clientWidth,u=document.body.clientHeight,d=i.offsetLeft,p=c-i.offsetLeft-s,f=i.offsetTop,m=u-i.offsetTop-l,g=a(i,"left"),h=a(i,"top");g.includes("%")?(g=+document.body.clientWidth*(+g.replace(/\%/g,"")/100),h=+document.body.clientHeight*(+h.replace(/\%/g,"")/100)):(g=+g.replace(/\px/g,""),h=+h.replace(/\px/g,"")),document.onmousemove=function(t){var o=t.clientX-e,a=t.clientY-r;-o>d?o=-d:o>p&&(o=p),-a>f?a=-f:a>m&&(a=m),i.style.cssText+=";left:".concat(o+g,"px;top:").concat(a+h,"px;"),n.child.$emit("dragDialog")},document.onmouseup=function(t){document.onmousemove=null,document.onmouseup=null}}}},i=function(t){t.directive("el-drag-dialog",o)};window.Vue&&(window["el-drag-dialog"]=o,Vue.use(i)),o.install=i;e["a"]=o},b045:function(t,e,n){"use strict";n.r(e);var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"liu-yan-guan-li"},[n("div",{staticClass:"top-control"},[n("el-button",{attrs:{size:"mini",type:"primary"},on:{click:t.onSendNews}},[t._v("发布")])],1),n("SendDialog",{attrs:{control:t.control},on:{fetch:t.fetchTable}}),n("EditDialog",{attrs:{control:t.control},on:{fetch:t.fetchTable},model:{value:t.editForm,callback:function(e){t.editForm=e},expression:"editForm"}}),n("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData}},[n("el-table-column",{attrs:{label:"商品主图",width:"180"},scopedSlots:t._u([{key:"default",fn:function(t){return[n("el-image",{staticStyle:{width:"100px",height:"100px"},attrs:{src:"/uploads/"+t.row.imgurl,"preview-src-list":["/uploads/"+t.row.imgurl],fit:"cover"}})]}}])}),n("el-table-column",{attrs:{label:"商品标题",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",{staticStyle:{"margin-left":"10px"}},[t._v(t._s(e.row.proName))])]}}])}),n("el-table-column",{attrs:{label:"商品分类",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",{staticStyle:{"margin-left":"10px"}},[t._v(t._s(e.row.proCatgory))])]}}])}),n("el-table-column",{attrs:{"show-overflow-tooltip":"",label:"商品主体内容",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",{staticStyle:{"margin-left":"10px"}},[t._v(t._s(e.row.procontent))])]}}])}),n("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(n){return t.edit(e.$index,e.row)}}},[t._v("修改")]),n("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(n){return t.deleteMsg(e.$index,e.row)}}},[t._v("删除")])]}}])})],1),n("div",{staticClass:"block"},[n("el-pagination",{attrs:{"current-page":t.requestBody.page,"page-sizes":[10,50,100],"page-size":t.requestBody.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:t.responseData.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)],1)},i=[],a=n("1da1"),r=(n("96cf"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-dialog",{directives:[{name:"el-drag-dialog",rawName:"v-el-drag-dialog"}],attrs:{title:"发布商品",visible:t.control.submit,width:"50%"},on:{"update:visible":function(e){return t.$set(t.control,"submit",e)}}},[n("div",{staticClass:"form-group"},[n("div",{staticClass:"title"},[t._v(" 商品标题: ")]),n("el-input",{model:{value:t.form.proName,callback:function(e){t.$set(t.form,"proName",e)},expression:"form.proName"}})],1),n("div",{staticClass:"form-group"},[n("div",{staticClass:"title"},[t._v(" 商品分类: ")]),n("el-input",{model:{value:t.form.proCatgory,callback:function(e){t.$set(t.form,"proCatgory",e)},expression:"form.proCatgory"}})],1),n("div",{staticClass:"form-group"},[n("div",{staticClass:"title"},[t._v(" 主图: ")]),n("el-upload",{ref:"upload",attrs:{action:"fakeaction",limit:1,"on-exceed":t.onExceed,"list-type":"picture-card","before-upload":t.onBeforeUpload,"http-request":t.onHttpRequest},scopedSlots:t._u([{key:"file",fn:function(e){var o=e.file;return n("div",{},[n("img",{staticClass:"el-upload-list__item-thumbnail",attrs:{src:o.url,alt:""}}),n("span",{staticClass:"el-upload-list__item-actions"},[n("span",{staticClass:"el-upload-list__item-preview",on:{click:function(e){return t.handlePictureCardPreview(o)}}},[n("i",{staticClass:"el-icon-zoom-in"})]),t.disabled?t._e():n("span",{staticClass:"el-upload-list__item-delete",on:{click:function(e){return t.handleRemove(o)}}},[n("i",{staticClass:"el-icon-delete"})])])])}}])},[n("i",{staticClass:"el-icon-plus",attrs:{slot:"default"},slot:"default"})])],1),n("div",{staticClass:"form-group"},[n("div",{staticClass:"title"},[t._v(" 内容编辑: ")]),n("markdown-editor",{ref:"MarkdownEditor",attrs:{height:"300px"},model:{value:t.form.procontent,callback:function(e){t.$set(t.form,"procontent",e)},expression:"form.procontent"}})],1),n("div",{staticClass:"form-group",staticStyle:{"text-align":"center"}},[n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(e){t.control.submit=!1}}},[t._v("取 消")]),n("el-button",{attrs:{type:"primary"},on:{click:t.onSendNewsAction}},[t._v("确 定")])],1)])])}),s=[],l=n("16d8"),c=n("a888"),u=n("5530"),d=n("b775");function p(t){return Object(d["a"])({url:"/pro/list",method:"post",data:Object(u["a"])({},t)})}function f(t){return Object(d["a"])({url:"/pro/delete",method:"post",data:Object(u["a"])({},t)})}function m(t){return Object(d["a"])({url:"/pro/send",method:"post",headers:{"content-type":"multipart/form-data"},data:t})}function g(t){return Object(d["a"])({url:"/pro/detail",method:"post",data:Object(u["a"])({},t)})}function h(t){return Object(d["a"])({url:"/pro/updateNoFile",method:"post",data:Object(u["a"])({},t)})}function v(t){return Object(d["a"])({url:"/pro/update",method:"post",headers:{"content-type":"multipart/form-data"},data:t})}function b(t){return Object(d["a"])({url:"/pro/sendNoFile",method:"post",data:Object(u["a"])({},t)})}var w=new FormData,y={name:"EditDialog",directives:{elDragDialog:c["a"]},components:{MarkdownEditor:l["a"]},props:{control:{type:Object}},data:function(){return{form:{},disabled:!1}},methods:{onSendNewsAction:function(){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,w.append("procontent",t.form.procontent),w.append("markdown",t.$refs.MarkdownEditor.getHtml()),w.append("proName",t.form.proName),w.append("proCatgory",t.form.proCatgory),console.log(w),!w.get("imgUrl")){e.next=12;break}return e.next=9,m(w);case 9:n=e.sent,e.next=15;break;case 12:return e.next=14,b(t.form);case 14:n=e.sent;case 15:"success"===n.status&&(t.$message.success("发布成功"),t.initForm()),console.log({"上传结果":n}),e.next=23;break;case 19:e.prev=19,e.t0=e["catch"](0),w=new FormData,t.$message.error("发布失败:"+e.t0);case 23:case"end":return e.stop()}}),e,null,[[0,19]])})))()},onBeforeUpload:function(t){var e="image/jpeg"===t.type,n=t.size/1024/1024<2;return e||this.$message.error("上传头像图片只能是 JPG 格式!"),n||this.$message.error("上传图片大小不能超过 2MB!"),e&&n},onExceed:function(){this.$message.warning("请先删除已选择上传图片")},handleRemove:function(t){var e=this;this.$nextTick((function(t){e.$refs.upload.fileList=[],e.$forceUpdate(),w.set("imgUrl","")}))},handlePictureCardPreview:function(t){this.dialogImageUrl=t.url,this.dialogVisible=!0},onHttpRequest:function(t){w.append("imgUrl",t.file)},initForm:function(){w=new FormData,this.$refs.upload.clearFiles(),this.$set(this,"form",{}),this.control.submit=!1,this.$emit("fetch")}}},x=y,k=(n("fd20"),n("0b81"),n("2877")),C=Object(k["a"])(x,r,s,!1,null,"ae69e6d8",null),_=C.exports,$=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-dialog",{directives:[{name:"el-drag-dialog",rawName:"v-el-drag-dialog"}],attrs:{title:"商品编辑",visible:t.control.edit,width:"50%"},on:{"update:visible":function(e){return t.$set(t.control,"edit",e)}}},[n("div",{staticClass:"form-group"},[n("div",{staticClass:"title"},[t._v(" 商品标题: ")]),n("el-input",{model:{value:t.value.proName,callback:function(e){t.$set(t.value,"proName",e)},expression:"value.proName"}})],1),n("div",{staticClass:"form-group"},[n("div",{staticClass:"title"},[t._v(" 商品分类: ")]),n("el-input",{model:{value:t.value.proCatgory,callback:function(e){t.$set(t.value,"proCatgory",e)},expression:"value.proCatgory"}})],1),n("div",{staticClass:"form-group"},[n("div",{staticClass:"title"},[t._v(" 主图: ")]),t.value.imgurl?n("el-image",{staticStyle:{width:"100px",height:"100px"},attrs:{src:"/uploads/"+t.value.imgurl,"preview-src-list":["/uploads/"+t.value.imgurl],fit:"cover"}}):n("el-empty",{attrs:{"image-size":40}}),n("el-upload",{ref:"upload",attrs:{action:"fakeaction",limit:1,"on-exceed":t.onExceed,"list-type":"picture-card","before-upload":t.onBeforeUpload,"http-request":t.onHttpRequest},scopedSlots:t._u([{key:"file",fn:function(e){var o=e.file;return n("div",{},[n("img",{staticClass:"el-upload-list__item-thumbnail",attrs:{src:o.url,alt:""}}),n("span",{staticClass:"el-upload-list__item-actions"},[n("span",{staticClass:"el-upload-list__item-preview",on:{click:function(e){return t.handlePictureCardPreview(o)}}},[n("i",{staticClass:"el-icon-zoom-in"})]),t.disabled?t._e():n("span",{staticClass:"el-upload-list__item-delete",on:{click:function(e){return t.handleRemove(o)}}},[n("i",{staticClass:"el-icon-delete"})])])])}}])},[n("i",{staticClass:"el-icon-plus",attrs:{slot:"default"},slot:"default"})])],1),n("div",{staticClass:"form-group"},[n("div",{staticClass:"title"},[t._v(" 内容编辑: ")]),n("markdown-editor",{ref:"MarkdownEditor",attrs:{height:"300px"},model:{value:t.value.procontent,callback:function(e){t.$set(t.value,"procontent",e)},expression:"value.procontent"}})],1),n("div",{staticClass:"form-group",staticStyle:{"text-align":"center"}},[n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(e){t.control.edit=!1}}},[t._v("取 消")]),n("el-button",{attrs:{type:"primary"},on:{click:t.onSendNewsAction}},[t._v("确 定")])],1)])])},S=[],j=new FormData,O={name:"EditDialog",directives:{elDragDialog:c["a"]},components:{MarkdownEditor:l["a"]},props:{value:{type:Object,required:!0},control:{type:Object}},data:function(){return{form:{},disabled:!1}},methods:{onSendNewsAction:function(){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,j.append("procontent",t.value.procontent),j.append("markdown",t.$refs.MarkdownEditor.getHtml()),j.append("proName",t.value.proName),j.append("id",t.value.id),j.append("proCatgory",t.value.proCatgory),!j.get("imgUrl")){e.next=12;break}return e.next=9,v(j);case 9:n=e.sent,e.next=15;break;case 12:return e.next=14,h(t.value);case 14:n=e.sent;case 15:"success"===n.status&&(t.$message.success("修改成功"),t.initForm()),console.log({"上传结果":n}),e.next=22;break;case 19:e.prev=19,e.t0=e["catch"](0),t.$message.error("发布失败:"+e.t0);case 22:case"end":return e.stop()}}),e,null,[[0,19]])})))()},onBeforeUpload:function(t){var e="image/jpeg"===t.type,n=t.size/1024/1024<2;return e||this.$message.error("上传头像图片只能是 JPG 格式!"),n||this.$message.error("上传图片大小不能超过 2MB!"),e&&n},onExceed:function(){this.$message.warning("请先删除已选择上传图片")},handleRemove:function(t){var e=this;console.log(t,{upload:this.$refs.upload}),this.$nextTick((function(t){e.$refs.upload.fileList=[],e.$forceUpdate(),j.set("imgUrl","")}))},handlePictureCardPreview:function(t){this.dialogImageUrl=t.url,this.dialogVisible=!0},onHttpRequest:function(t){j.append("imgUrl",t.file)},initForm:function(){j=new FormData,this.$refs.upload.clearFiles(),this.$set(this,"form",{}),this.control.edit=!1,this.$emit("fetch")}}},E=O,D=(n("f515"),n("3df7"),Object(k["a"])(E,$,S,!1,null,"558b929e",null)),N=D.exports,R={name:"LiuYanGuanLi",components:{SendDialog:_,EditDialog:N},data:function(){return{control:{submit:!1,edit:!1},editForm:{},dialogVisible:!1,tableData:[],requestBody:{page:1,pageSize:10,name:""},responseData:{total:100}}},created:function(){this.fetchTable()},methods:{onSendNews:function(){this.control.submit=!0},edit:function(t,e){var n=this;return Object(a["a"])(regeneratorRuntime.mark((function o(){var i,a;return regeneratorRuntime.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return n.$set(n.control,"edit",!0),o.prev=1,i={id:e.id},console.log(t),o.next=6,g(i);case 6:a=o.sent,console.log({"获取详情详细结果":a}),n.$set(n,"editForm",null===a||void 0===a?void 0:a.data[0]),o.next=14;break;case 11:o.prev=11,o.t0=o["catch"](1),n.$message.error("获取详情失败"+o.t0);case 14:console.log({row:t,index:e});case 15:case"end":return o.stop()}}),o,null,[[1,11]])})))()},deleteMsgAction:function(t,e){var n=this;return Object(a["a"])(regeneratorRuntime.mark((function t(){var o,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,o={id:e.id},t.next=4,f(o);case 4:i=t.sent,console.log({"删除":i}),n.$message.success("删除成功"),t.next=12;break;case 9:t.prev=9,t.t0=t["catch"](0),n.$message.warning("删除数据失败",t.t0);case 12:return t.prev=12,n.fetchTable(),t.finish(12);case 15:case"end":return t.stop()}}),t,null,[[0,9,12,15]])})))()},deleteMsg:function(t,e){var n=this;return Object(a["a"])(regeneratorRuntime.mark((function o(){return regeneratorRuntime.wrap((function(o){while(1)switch(o.prev=o.next){case 0:n.$confirm("此操作将永久该条数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){n.deleteMsgAction(t,e)})).catch((function(){n.$message({type:"info",message:"已取消删除"})}));case 1:case"end":return o.stop()}}),o)})))()},fetchTable:function(){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function e(){var n,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,n=t.requestBody,e.next=4,p(n);case 4:o=e.sent,console.log({result:o}),t.$message.success("数据获取成功"),t.$set(t,"tableData",o.data),t.$set(t.responseData,"total",o.total),e.next=15;break;case 11:e.prev=11,e.t0=e["catch"](0),console.log(e.t0),t.$message.warning("获取数据失败",e.t0);case 15:case"end":return e.stop()}}),e,null,[[0,11]])})))()},handleDelete:function(t,e){console.log(t,e)},handleSizeChange:function(t){this.$set(this.requestBody,"pageSize",t),this.fetchTable(),console.log("每页 ".concat(t," 条"))},handleCurrentChange:function(t){this.$set(this.requestBody,"page",t),this.fetchTable(),console.log("当前页: ".concat(t))}}},q=R,F=(n("7c98"),Object(k["a"])(q,o,i,!1,null,"1f6a4ef2",null));e["default"]=F.exports},df89:function(t,e,n){},f515:function(t,e,n){"use strict";n("89f1")},fd20:function(t,e,n){"use strict";n("58a6")}}]);